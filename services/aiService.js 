const Groq = require("groq-sdk");
const client = new Groq({ apiKey: process.env.GROQ_API_KEY });

async function askAI(text) {
  const systemPrompt = `
أنت موظف خدمة عملاء في عيادة طبية...
(نفس النص السابق)
  `;
  const completion = await client.chat.completions.create({
    model: "llama-3.3-70b-versatile",
    messages: [
      { role: "system", content: systemPrompt },
      { role: "user", content: text },
    ],
  });
  return completion.choices[0]?.message?.content || "عذرًا، لم أفهم سؤالك.";
}

async function validateNameWithAI(name) {
  const completion = await client.chat.completions.create({
    model: "llama-3.3-70b-versatile",
    messages: [
      {
        role: "user",
        content: `هل "${name}" يبدو كاسم عربي حقيقي؟ أجب بنعم أو لا.`,
      },
    ],
    temperature: 0,
  });
  return completion.choices[0]?.message?.content?.trim().startsWith("نعم");
}

module.exports = { askAI, validateNameWithAI };
